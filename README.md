# LSTM-for-predicting-returns
Our, Benjamin von Essen's and Haohang Wu's, project in the course 4330 - Macroeconomics and Finance, Spring 2021 at SSE.

![](https://github.com/tekniktomten/LSTM-for-predicting-returns/blob/main/top10_21.png)

*Figure 8. Buying top 10, monthly. Portfolio development over time when, each month, buying the top 10 predicted stocks, with a forecast horizon of one month, and selling them next month (in yellow) versus buying all stocks equally weighted (in green).*

Abstract:
Deep learning has been in the spotlight during the recent years thanks to its ability to model complex non-linear phenomena, which has proved useful in the field of asset pricing, which historically has depended heavily on linear models. While the standard multilayer perceptron has shows promise for use in asset pricing, they lack a sense of temporal dependencies, which is problematic since most data used is inherently on time series form. Thus, an LSTM model might be more suitable, since it can learn temporal dependencies. In this project we develop a LSTM model with a novel loss function which we train to predict cumulative returns in the future, given the last years values of 34 different features, ranging from firm level ratios and trading data to large scale factors, for the current 30 stocks included in the DJIA, as well as 19 stocks that used to be included. Following a couple of different simple buying strategies based on the predictions of our network, we managed, in all cases tested, to outperform the equally weighted index of stocks, for out-of-sample data in our test dataset, which included the Covid-19 crisis. Analyzing the weights of our trained network, we identify that the main features that are used by the network are the 5 Fama French factors, momentum and financial ratios.
